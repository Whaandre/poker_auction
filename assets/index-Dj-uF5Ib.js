(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();let p=prompt("Enter your name")||"";const k="wss://poker-auction.onrender.com",l=new WebSocket(k);let b=[];const f=document.getElementById("messages"),y=document.getElementById("auctionBox"),u=document.getElementById("guessBox"),a=document.getElementById("lots"),v=document.getElementById("money"),g=document.getElementById("bidBtn"),E=document.getElementById("guessBtn"),m=document.getElementById("guessTarget"),$=document.getElementById("guessRank"),B=document.getElementById("guessSuit"),S=document.getElementById("guessInfo");function i(e){const t=document.createElement("p");t.textContent=e,f.appendChild(t),f.scrollTop=f.scrollHeight}function C(){l.readyState===WebSocket.OPEN&&l.send(JSON.stringify({type:"join",name:p}))}l.addEventListener("open",()=>{i("Connected to server"),C()});l.addEventListener("message",e=>{const t=JSON.parse(e.data);H(t)});function H(e){switch(e.type){case"joinRejected":alert(e.message),p=prompt("Enter your name")||"",C();break;case"playerJoined":i(`${e.playerId} joined (${e.totalPlayers})`);break;case"gameStart":i("Game started!"),u.style.display="none",g.style.display="inline-block",h(e.players),x(e.lots);break;case"startAuction":N(e);break;case"auctionResult":e.results.forEach(t=>i(`Lot ${t.lotId} won by ${t.winnerId} ($${t.pricePaid})`)),h(e.players);break;case"startGuessing":O();break;case"gameOver":i("Game Over! Scores calculated."),w(e);break;case"bidAccepted":i("Bid Accepted"),y.style.display="none";break;case"bidRejected":i(`Error: ${e.message}`);break}}function I(e){return e===14||e===1?"A":e===11?"J":e===12?"Q":e===13?"K":String(e)}function T(e){switch(e){case"H":return{symbol:"â™¥",color:"red"};case"D":return{symbol:"â™¦",color:"red"};case"S":return{symbol:"â™ ",color:"black"};case"C":return{symbol:"â™£",color:"black"};default:return{symbol:"?",color:"black"}}}function c(e,t=!1){const{symbol:o,color:s}=T(e.suit),n=document.createElement("div");return n.className="card",n.style.color=s,t&&(n.style.border="2px solid gold",n.style.backgroundColor="#fffbe6",n.style.boxShadow="0 0 5px gold",n.style.transform="scale(1.1)",n.style.zIndex="1",n.style.position="relative"),n.innerHTML=`<div class="card-rank">${I(e.rank)}</div><div class="card-suit">${o}</div>`,n}function M(){const e=document.createElement("div");return e.className="card unknown",e.innerHTML='<div class="card-rank">?</div><div class="card-suit"></div>',e}function h(e){b=e;const t=document.getElementById("players");t.innerHTML="",e.forEach(o=>{const s=document.createElement("div");s.className="player",s.innerHTML=`<strong>${o.id}</strong> â€” $${o.money}`;const n=document.createElement("div");n.style.margin="5px 0",n.innerHTML='<span style="font-size:0.9em">Hidden: </span>',o.id===p&&o.hiddenCard?n.appendChild(c(o.hiddenCard)):n.appendChild(M()),s.appendChild(n);const r=document.createElement("div");r.innerHTML='<span style="font-size:0.9em">Earned: </span>',o.earnedCards.forEach(d=>r.appendChild(c(d))),s.appendChild(r),t.appendChild(s)})}function x(e){a.innerHTML="",e.forEach(t=>{const o=document.createElement("div");o.className="lot",o.style.marginBottom="10px",o.innerHTML=`<strong>Lot ${t.id}</strong> `,t.cards.forEach(s=>o.appendChild(c(s))),a.appendChild(o)})}function w(e){y.style.display="block",u.style.display="none",a.innerHTML="",v.innerHTML="<h2 style='color: #d32f2f'>Final Scores</h2>",g.style.display="none",e.scores.forEach((t,o)=>{const s=document.createElement("div");s.className="box",s.style.borderLeft=o===0?"5px solid gold":"1px solid #ddd";const n=o===0?"ðŸ‘‘ ":"";s.innerHTML=`
      <h3>${n}#${o+1} ${t.playerId}</h3>
      <p><strong>Total Score: ${Math.floor(t.totalScore)}</strong></p>
      <ul style="font-size: 0.9em; margin-bottom: 10px;">
        <li>Hand Rank: ${t.handRankName} (${t.rank}th place prize: ${t.prizeScore})</li>
        <li>Guess Bonus: ${t.guessScore}</li>
        <li>Leftover Money: ${t.moneyScore}</li>
      </ul>
      <div style="font-size: 0.9em; font-weight: bold;">Best 5-Card Hand:</div>
    `;const r=document.createElement("div");r.style.marginTop="5px",t.bestHand.forEach(L=>{r.appendChild(c(L,!0))});const d=document.createElement("div");d.style.marginTop="10px",d.style.fontSize="0.9em",d.innerHTML="<strong>Hidden Card Revealed:</strong> ",d.appendChild(c(t.hiddenCard)),s.appendChild(r),s.appendChild(d),a.appendChild(s)})}function N(e){y.style.display="block",u.style.display="none",a.innerHTML="",v.textContent=`Money: $${e.money}`,e.lotIds.forEach(t=>{const o=document.createElement("div");o.style.margin="8px 0",o.innerHTML=`
      <label style="display:inline-block; width: 60px;">Lot ${t}:</label>
      <input data-lotid="${t}" type="number" placeholder="Bid (0)" style="width: 80px;" />
    `,a.appendChild(o)})}g.onclick=()=>{const e=[];a.querySelectorAll("input").forEach(o=>{const s=Number(o.dataset.lotid),n=o.value,r=n===""?0:Number(n);e.push({lotId:s,amount:r})});const t={type:"bid",bids:e};l.send(JSON.stringify(t)),i("Bids submitted")};function O(e){u.style.display="block",y.style.display="none",S.innerHTML="<h4>Guessing Phase</h4><p>Identify hidden cards!</p>",m.innerHTML="",b.forEach(t=>{if(t.id!==p){const o=document.createElement("option");o.value=t.id,o.textContent=t.id,m.appendChild(o)}}),m.disabled=!1,E.disabled=!1}E.onclick=()=>{const e=m.value,t=$.value,o=B.value;if(!e)return;const s={type:"guess",targetPlayerId:e,card:o+t};l.send(JSON.stringify(s)),i(`Guessed ${e}`),u.style.display="none"};
